<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Dashboard Treinamentos HCM - Comercial</title>

<!-- Fonte e estilo visual -->
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #111;
        color: #eee;
    }
    header {
        background: #1e1e1e;
        padding: 15px;
        text-align: center;
        border-bottom: 2px solid #444;
    }
    header img {
        height: 60px;
        margin-bottom: 10px;
    }
    h1 {
        margin: 5px 0 0 0;
        font-size: 22px;
        color: #fff;
    }

    .container {
        display: flex;
        height: calc(100vh - 90px);
    }
    .left-panel {
        width: 320px;
        background: #181818;
        border-right: 2px solid #333;
        padding: 15px;
        overflow-y: auto;
    }
    .left-panel h2 {
        margin-top: 0;
        color: #fff;
        font-size: 18px;
    }
    .module-item {
        background: #222;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 8px;
        cursor: pointer;
        border: 1px solid #333;
    }
    .module-item:hover {
        background: #2d2d2d;
    }

    .right-panel {
        flex: 1;
        padding: 15px;
        overflow-y: auto;
    }

    .summary-box {
        background: #1a1a1a;
        border: 2px solid #333;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        gap: 15px;
    }
    .summary-card {
        flex: 1;
        padding: 12px;
        background: #222;
        border-radius: 8px;
        border: 1px solid #444;
        text-align: center;
    }
    .summary-big {
        flex: 2;
        padding: 12px;
        background: #222;
        border-radius: 8px;
        border: 1px solid #444;
        text-align: center;
        font-size: 20px;
    }

    .routine-card {
        background: #1c1c1c;
        border: 1px solid #333;
        margin-bottom: 10px;
        padding: 12px;
        border-radius: 8px;
    }
    .routine-header {
        display: flex;
        justify-content: space-between;
    }
    .checkbox {
        transform: scale(1.3);
        margin-right: 10px;
    }

    table {
        width: 100%;
        margin-top: 10px;
        border-collapse: collapse;
        color: #ddd;
    }
    table td {
        padding: 6px;
        border-bottom: 1px solid #333;
    }

    .form-section {
        background: #1a1a1a;
        border: 1px solid #333;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    .form-section label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }
    .form-section input {
        width: 100%;
        padding: 8px;
        margin-top: 4px;
        background: #222;
        color: #fff;
        border: 1px solid #555;
        border-radius: 6px;
    }

    .btn {
        background: #007bff;
        color: #fff;
        padding: 12px 20px;
        border-radius: 8px;
        border: 0;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    .btn:hover {
        background: #0a89ff;
    }
</style>

</head>

<body>

<header>
    <img src="logo.png" alt="Komvos">
    <h1>Dashboard Comercial – Treinamentos HCM</h1>
</header>

<div class="container">

    <!-- Painel esquerdo -->
    <div class="left-panel">
        <h2>Módulos</h2>
        <div id="moduleList"></div>
    </div>

    <!-- Painel direito -->
    <div class="right-panel">

        <!-- CAMPOS DO CLIENTE / CONTATO / DATA / VALIDADE -->
        <div class="form-section">
            <label>Cliente:</label>
            <input id="clienteInput" type="text">

            <label>Contato (Telefone):</label>
            <input id="contatoInput" type="text" placeholder="(11) 99999-9999">

            <label>Data:</label>
            <input id="dataInput" type="text" disabled>

            <label>Validade da Proposta:</label>
            <input id="validadeInput" type="date">
        </div>

        <!-- RESUMO -->
        <div class="summary-box">
            <div class="summary-card">
                <h3>Módulos Selecionados</h3>
                <div id="modCount">0</div>
            </div>

            <div class="summary-card">
                <h3>Horas Totais</h3>
                <div id="totalHours">0</div>
            </div>

            <div class="summary-big">
                <h3>Custo Estimado</h3>
                <div id="estimatedCost">R$ 0,00</div>
                <small>Valor hora base: R$ 120,00</small>
            </div>
        </div>

        <h2>Rotinas Selecionadas</h2>
        <div id="routineList"></div>

        <button class="btn" onclick="generatePDF()">Gerar PDF</button>

    </div>
</div>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
// ============================
//  CSV EMBUTIDO NO HTML
// ============================

const csvText = `
MÓDULO;ROTINA;MÓDULO - ROTINA;ESPECIFICAÇÃO;HORAS;TOTAL ROTINA;TOTAL MÓDULO
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Valores (Tabelas INSS, Tabela IRRF, Valores Gerais);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Eventos (Tabela, Eventos, Regras Nativas, Base, Incidências e Exceções);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Ogranograma (Estrutura e Locais);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Postos de Trabalho (Estrutura, Perfil, Cadastro Postos, Hierarquia de Postos, Adicionais, Infomrações Salariais);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Sindicatos (Cadastro Geral e Normativos);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Motivos (Causas Demissão, Motivos Reajuste Salarial, Motivos Demissão);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Tabelas Gerais (Bancos, Cidades, Bairros, CEPs, Situações, Conselhos Profissionais, Vinculos, Graus de Instrução, Nacionalidades e Deficiências);0,50;4,00;68,00
Administração de Pessoal;Tabelas;Administração de Pessoal — Tabelas;Treinamento Relatórios do Menu  Tabelas;0,50;4,00;68,00
Administração de Pessoal;Empresas;Administração de Pessoal — Empresas;Treinamento Cadastro de Empresas;0,50;2,00;68,00
Administração de Pessoal;Empresas;Administração de Pessoal — Empresas;Treinamento Cadastro de Filiais;0,50;2,00;68,00
Administração de Pessoal;Empresas;Administração de Pessoal — Empresas;Treinamento Cadastro Outras Empresas;0,50;2,00;68,00
Administração de Pessoal;Empresas;Administração de Pessoal — Empresas;Treinamento Grupo de Empresas;0,25;2,00;68,00
Administração de Pessoal;Empresas;Administração de Pessoal — Empresas;Treinamento Relatórios Cadastrais e Gerenciais Empresas;0,25;2,00;68,00
Administração de Pessoal;Pessoas;Administração de Pessoal — Pessoas;Treinamento Cadastro Pessoas;0,25;1,00;68,00
Administração de Pessoal;Pessoas;Administração de Pessoal — Pessoas;Treinamento Gerar Pessoas;0,25;1,00;68,00
Administração de Pessoal;Pessoas;Administração de Pessoal — Pessoas;Treinamento Consistir Pessoas;0,25;1,00;68,00
Administração de Pessoal;Pessoas;Administração de Pessoal — Pessoas;Treinamento Excluir Pessoas;0,25;1,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Ficha Cadastral;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Ficha Complementar;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Dependentes;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Manutenção de Históricos;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Pensão Judicial;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Estagiários;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Informações Admissionais;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Cadastro Terceiros;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Vinculação Fotos (individual e coletiva);0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Relatórios Relação de Cadastro;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Relatórios Históricos;0,50;6,00;68,00
Administração de Pessoal;Colaboradores;Administração de Pessoal — Colaboradores;Treinamento Relatório Dependentes e Pensão Judicial;0,50;6,00;68,00
Administração de Pessoal;Estrutura Salarial;Administração de Pessoal — Estrutura Salarial;Treinamento Cadastro Estrutura Salarial;0,50;2,50;68,00
Administração de Pessoal;Estrutura Salarial;Administração de Pessoal — Estrutura Salarial;Treinamento Reajuste Estrutura Salarial;0,50;2,50;68,00
Administração de Pessoal;Estrutura Salarial;Administração de Pessoal — Estrutura Salarial;Treinamento Duplicação Estrutura Salarial;0,50;2,50;68,00
Administração de Pessoal;Estrutura Salarial;Administração de Pessoal — Estrutura Salarial;Treinamento Relatórios Estrutura Salarial;0,50;2,50;68,00
Administração de Pessoal;Estrutura Salarial;Administração de Pessoal — Estrutura Salarial;Treinamento Vinculação Estrutura Salrial em Cargos e Postos de Trabalho;0,50;2,50;68,00
Administração de Pessoal;Salários;Administração de Pessoal — Salários;Treinamento Historico Salarial Individual;0,50;2,50;68,00
Administração de Pessoal;Salários;Administração de Pessoal — Salários;Treinamento Lançamento Histórico Salarial;0,50;2,50;68,00
Administração de Pessoal;Salários;Administração de Pessoal — Salários;Treinamento Reajuste Salarial Coletivo;0,50;2,50;68,00
Administração de Pessoal;Salários;Administração de Pessoal — Salários;Treinamento Ajustar Salários (com Estrutura/Classe/Nível);0,50;2,50;68,00
Administração de Pessoal;Salários;Administração de Pessoal — Salários;Treinamento Cancelar Reajustes Salariais;0,50;2,50;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Períodos de Férias;0,50;4,00;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Totalizadores de Férias (Cadastro e Acumular);0,50;4,00;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Programação de Férias (Individual, Coletiva, Gerar e Excluir);0,50;4,00;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Relatórios e Consultas Programação de Férias;0,50;4,00;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Recibos Coletivos de Férias;0,50;4,00;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Cálculo Recibo de Férias (Individual, Coletivo, Programadas, Exclusão e Alterar Gozo);1,00;4,00;68,00
Administração de Pessoal;Férias;Administração de Pessoal — Férias;Treinamento Relatórios de Férias (Aviso, Recibo e Demonstrativo de Médias);0,50;4,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento Calcular Rescisão;1,00;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinar Rescisão Informada;0,50;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinar Recisão Coletiva;0,50;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinar Cadastro e Geração Aviso Prévio;0,50;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento de Programção de Rescisões;0,50;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento Cálculo de Rescisões Calculadas;0,50;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento Exclusão de Rescisão;0,25;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento Alteração de Rescisão;0,25;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento Rescisão Complementar;1,00;6,00;68,00
Administração de Pessoal;Rescisão;Administração de Pessoal — Rescisão;Treinamento Relatórios Rescisão;1,00;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinar Criação de Cálculos;1,00;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinar Lançamentos Fixos (suas diversas formas);0,75;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinar Lançamentos Variáveis (suas diversas formas);0,75;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinar Tela Lançamentos Fixos e Variáveis;0,50;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Cálculos e Recálculos da Folha;1,00;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinamento Tela Ficha Financeira;0,50;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinamento Relatórios Ficha Financeira;0,50;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinamento Resumos de Folha e Relações de Líquidos;0,50;6,00;68,00
Administração de Pessoal;Cálculos;Administração de Pessoal — Cálculos;Treinamento Geração Arquivo Bancário;0,50;6,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cadastro de Provisões;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cálculo de Provisões;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Consulta Provisões;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Relatórios Provisões;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Definições Contábeis;0,50;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cadastrar Centros de Custos;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cadastrar CLCs;0,50;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Natureza de Despesa;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Assinalar CLCs;0,50;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cadastrar Rateios;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Assinalar Rateios;0,25;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cadastro Contas Contábeis;0,50;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Cálculo Contabilização;0,50;5,00;68,00
Administração de Pessoal;Contabilização;Administração de Pessoal — Contabilização;Relatórios Contábeis;0,50;5,00;68,00
Administração de Pessoal;Criação Arquivo Contábil;Administração de Pessoal — Criação Arquivo Contábil;Desenvolvimento Arquivo TXT Contábil (Forma nativa do sistema sem regras);7,50;8,00;68,00
Administração de Pessoal;Criação Arquivo Contábil;Administração de Pessoal — Criação Arquivo Contábil;Geração Arquivo TXT;0,50;8,00;68,00
Administração de Pessoal;Integração ERP;Administração de Pessoal — Integração ERP;Definições de Integrações Financeiras;0,25;5,00;68,00
Administração de Pessoal;Integração ERP;Administração de Pessoal — Integração ERP;Cadastro de CIFs;2,00;5,00;68,00
Administração de Pessoal;Integração ERP;Administração de Pessoal — Integração ERP;Consulta de Pendências;0,50;5,00;68,00
Administração de Pessoal;Integração ERP;Administração de Pessoal — Integração ERP;Recriação de Pendências;0,25;5,00;68,00
Administração de Pessoal;Integração ERP;Administração de Pessoal — Integração ERP;Integração Financeira;1,00;5,00;68,00
Administração de Pessoal;Integração ERP;Administração de Pessoal — Integração ERP;Relatórios da Rotina;1,00;5,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Definições eSocial;0,50;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Parâmetros no Cadastro de Empresas e Filiais;1,00;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Parâmetros nos Cadastro de Eventos;0,50;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Geração de Tabelas;0,50;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Fechamento de Admissão;0,50;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Fechamento de Demissão;0,50;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Geração de Não Periódicos;1,00;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Geração de Periódicos;1,00;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Tela de Consulta de Pendências e Envio;0,50;7,00;68,00
Administração de Pessoal;eSocial;Administração de Pessoal — eSocial;Relatórios de Retorno do eSocial;1,00;7,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Incidências INSS;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Geração Relatórios e Conferência INSS;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Incidências FGTS;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Geração Relatórios e Conferência FGTS;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Incidências IRRF;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Geração Relatórios e Conferência IRRF;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Indicências PIS;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Geração Relatórios e Conferência PIS;0,50;5,00;68,00
Administração de Pessoal;Impostos;Administração de Pessoal — Impostos;Validação Impostos eSocial;1,00;5,00;68,00
Administração de Pessoal;Anuais;Administração de Pessoal — Anuais;Parametrizações DIRF;1,00;4,00;68,00
Administração de Pessoal;Anuais;Administração de Pessoal — Anuais;Geração DIRF;0,50;4,00;68,00
Administração de Pessoal;Anuais;Administração de Pessoal — Anuais;Conferência DIRF;1,00;4,00;68,00
Administração de Pessoal;Anuais;Administração de Pessoal — Anuais;Geração Arquivo TXT e Relatórios DIRF;1,00;4,00;68,00
Administração de Pessoal;Anuais;Administração de Pessoal — Anuais;Geração Informe de Rendimento;0,50;4,00;68,00
Benefícios;Vales;Benefícios — Vales;Parametrização e simulação da Rotina;2,00;3,00;18,00
Benefícios;Vales;Benefícios — Vales;Relatórios da Rotina;0,50;3,00;18,00
Benefícios;Vales;Benefícios — Vales;Integração Folha de Pagamento;0,50;3,00;18,00
Benefícios;Assistência;Benefícios — Assistência;Parametrização e Assinalamento;1,00;2,50;18,00
Benefícios;Assistência;Benefícios — Assistência;Lançamento Despesas;0,50;2,50;18,00
Benefícios;Assistência;Benefícios — Assistência;Relatórios da Rotina;0,50;2,50;18,00
Benefícios;Assistência;Benefícios — Assistência;Integração Folha de Pagamento;0,50;2,50;18,00
Benefícios;Émpréstimo Consignado;Benefícios — Émpréstimo Consignado;Parametrização e simulação da Rotina;1,00;3,00;18,00
Benefícios;Émpréstimo Consignado;Benefícios — Émpréstimo Consignado;Relatórios da Rotina;1,00;3,00;18,00
Benefícios;Émpréstimo Consignado;Benefícios — Émpréstimo Consignado;Integração Folha de Pagamento;1,00;3,00;18,00
Benefícios;Empréstimos;Benefícios — Empréstimos;Parametrização e simulação da Rotina;2,00;3,50;18,00
Benefícios;Empréstimos;Benefícios — Empréstimos;Relatórios da Rotina;1,00;3,50;18,00
Benefícios;Empréstimos;Benefícios — Empréstimos;Integração Folha de Pagamento;0,50;3,50;18,00
Benefícios;Auxílio Creche;Benefícios — Auxílio Creche;Parametrização e simulação da Rotina;1,00;2,00;18,00
Benefícios;Auxílio Creche;Benefícios — Auxílio Creche;Relatórios da Rotina;0,50;2,00;18,00
Benefícios;Auxílio Creche;Benefícios — Auxílio Creche;Integração Folha de Pagamento;0,50;2,00;18,00
Benefícios;Vale Transporte;Benefícios — Vale Transporte;Parametrização e simulação da Rotina;2,00;4,00;18,00
Benefícios;Vale Transporte;Benefícios — Vale Transporte;Relatórios da Rotina;1,00;4,00;18,00
Benefícios;Vale Transporte;Benefícios — Vale Transporte;Integração Folha de Pagamento;1,00;4,00;18,00
Segurança do Trabalho;Tabelas Gerais;Segurança do Trabalho — Tabelas Gerais;Demonstração Cadastral das Tabelas Gerais do Módulo;2,00;2,00;40,00
Segurança do Trabalho;Configurações;Segurança do Trabalho — Configurações;Configurações e Definições do Módulo;2,00;2,00;40,00
Segurança do Trabalho;Brigada;Segurança do Trabalho — Brigada;Treinamento da Rotina;1,50;2,00;40,00
Segurança do Trabalho;Brigada;Segurança do Trabalho — Brigada;Demonstração Relatórios;0,50;2,00;40,00
Segurança do Trabalho;Planos de Ação;Segurança do Trabalho — Planos de Ação;Treinamento da Rotina;3,00;4,00;40,00
Segurança do Trabalho;Planos de Ação;Segurança do Trabalho — Planos de Ação;Demonstração Relatórios;1,00;4,00;40,00
Segurança do Trabalho;CIPA;Segurança do Trabalho — CIPA;Treinamento da Rotina;3,00;4,00;40,00
Segurança do Trabalho;CIPA;Segurança do Trabalho — CIPA;Demonstração Relatórios;1,00;4,00;40,00
Segurança do Trabalho;Equipamentos;Segurança do Trabalho — Equipamentos;Treinamento da Rotina;3,00;4,00;40,00
Segurança do Trabalho;Equipamentos;Segurança do Trabalho — Equipamentos;Demonstração Relatórios;1,00;4,00;40,00
Segurança do Trabalho;EPIs;Segurança do Trabalho — EPIs;Treinamento da Rotina;3,00;4,00;40,00
Segurança do Trabalho;EPIs;Segurança do Trabalho — EPIs;Demonstração Relatórios;1,00;4,00;40,00
Segurança do Trabalho;PGR por GHE;Segurança do Trabalho — PGR por GHE;Treinamento da Rotina;6,00;8,00;40,00
Segurança do Trabalho;PGR por GHE;Segurança do Trabalho — PGR por GHE;Demonstração Relatórios;2,00;8,00;40,00
Segurança do Trabalho;Acidentes de Trabalho;Segurança do Trabalho — Acidentes de Trabalho;Treinamento da Rotina;3,00;4,00;40,00
Segurança do Trabalho;Acidentes de Trabalho;Segurança do Trabalho — Acidentes de Trabalho;Demonstração Relatórios;1,00;4,00;40,00
Segurança do Trabalho;PPP;Segurança do Trabalho — PPP;Treinamento da Rotina;2,00;3,00;40,00
Segurança do Trabalho;PPP;Segurança do Trabalho — PPP;Demonstração Relatórios;1,00;3,00;40,00
Segurança do Trabalho;eSocial;Segurança do Trabalho — eSocial;Geração eventos eSocial (S-2240 e S-2210);3,00;3,00;40,00
Medicina Ocupacional;Tabelas Gerais;Medicina Ocupacional — Tabelas Gerais;Demonstração Cadastral das Tabelas Gerais do Módulo;1,50;1,50;40,00
Medicina Ocupacional;Configurações;Medicina Ocupacional — Configurações;Configurações e Definições do Módulo;1,50;1,50;40,00
Medicina Ocupacional;Ficha Médica;Medicina Ocupacional — Ficha Médica;Cadastro, Geração e Consultas da Ficha Médica;2,00;4,00;40,00
Medicina Ocupacional;Ficha Médica;Medicina Ocupacional — Ficha Médica;Prontuário Clínico;1,00;4,00;40,00
Medicina Ocupacional;Ficha Médica;Medicina Ocupacional — Ficha Médica;Relatórios da Rotina;1,00;4,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Atendentes;2,00;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Pré Atendimento;1,50;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Questionários;1,00;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Receitas Médicas;0,50;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Atestados;0,50;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Medicamentos;1,00;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Atendimentos;2,50;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Atestado Externo;0,50;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;ASO Externo;1,00;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Encaminhamentos;0,50;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Pedido Exames;1,00;14,00;40,00
Medicina Ocupacional;Atendimentos;Medicina Ocupacional — Atendimentos;Relatórios da Rotina;2,00;14,00;40,00
Medicina Ocupacional;PCMSO;Medicina Ocupacional — PCMSO;Cadastro de Exames;2,00;9,00;40,00
Medicina Ocupacional;PCMSO;Medicina Ocupacional — PCMSO;Periodicidade Exames por GHE;2,00;9,00;40,00
Medicina Ocupacional;PCMSO;Medicina Ocupacional — PCMSO;Geração Exames;1,00;9,00;40,00
Medicina Ocupacional;PCMSO;Medicina Ocupacional — PCMSO;Resultados Exames;2,00;9,00;40,00
Medicina Ocupacional;PCMSO;Medicina Ocupacional — PCMSO;Consultas;1,00;9,00;40,00
Medicina Ocupacional;PCMSO;Medicina Ocupacional — PCMSO;Relatórios da Rotina;1,00;9,00;40,00
Medicina Ocupacional;Audiometria;Medicina Ocupacional — Audiometria;Cadastros da Rotina;2,00;5,00;40,00
Medicina Ocupacional;Audiometria;Medicina Ocupacional — Audiometria;Orientações Preenchimentos;1,00;5,00;40,00
Medicina Ocupacional;Audiometria;Medicina Ocupacional — Audiometria;Cadastro Resultados;1,00;5,00;40,00
Medicina Ocupacional;Audiometria;Medicina Ocupacional — Audiometria;Relatorios da Rotina;1,00;5,00;40,00
Medicina Ocupacional;Vacinas;Medicina Ocupacional — Vacinas;Cadastro Medicamentos;1,00;3,00;40,00
Medicina Ocupacional;Vacinas;Medicina Ocupacional — Vacinas;Criação Campanhas e Publicos Alvo;1,00;3,00;40,00
Medicina Ocupacional;Vacinas;Medicina Ocupacional — Vacinas;Registro Aplicações;0,50;3,00;40,00
Medicina Ocupacional;Vacinas;Medicina Ocupacional — Vacinas;Relatórios da Rotina;0,50;3,00;40,00
Medicina Ocupacional;eSocial;Medicina Ocupacional — eSocial;Geração eventos eSocial (S-2220);2,00;2,00;40,00
Quadro de Vagas;Definições Empresas;Quadro de Vagas — Definições Empresas;Parâmetros iniciais e vínculos de empresas.;3,00;3,00;24,00
Quadro de Vagas;Plano de Vagas;Quadro de Vagas — Plano de Vagas;Planejamento e estruturação do quadro de vagas previsto.;2,00;4,00;24,00
Quadro de Vagas;Plano de Vagas;Quadro de Vagas — Plano de Vagas;Definição Hierarquia de Postos do Quadro;2,00;4,00;24,00
Quadro de Vagas;Normalização;Quadro de Vagas — Normalização;Normalização do Quadro Realizado;2,00;6,00;24,00
Quadro de Vagas;Normalização;Quadro de Vagas — Normalização;Gestão de reservas e movimentações de colaboradores.;2,00;6,00;24,00
Quadro de Vagas;Normalização;Quadro de Vagas — Normalização;Normalização/Geração do Quadro Previsto;2,00;6,00;24,00
Quadro de Vagas;Manutenção;Quadro de Vagas — Manutenção;Administração de Vagas;3,00;6,00;24,00
Quadro de Vagas;Manutenção;Quadro de Vagas — Manutenção;Manutenção de Vagas;3,00;6,00;24,00
Quadro de Vagas;Propostas;Quadro de Vagas — Propostas;Criação e aprovação de propostas de alteração de quadro conforme Hierquia utilizada no Plano de Vagas;2,00;2,00;24,00
Quadro de Vagas;Telas Consultas;Quadro de Vagas — Telas Consultas;Exploração das telas e consultas disponíveis.;1,50;1,50;24,00
Quadro de Vagas;Relatórios do Módulo;Quadro de Vagas — Relatórios do Módulo;Principais Relatórios do Módulo;1,50;1,50;24,00
Orçamento de Pessoal;Definições do Módulo;Orçamento de Pessoal — Definições do Módulo;Estruturação inicial e parâmetros gerais;2,00;2,00;32,00
Orçamento de Pessoal;Cenários, Visões e Revisões;Orçamento de Pessoal — Cenários, Visões e Revisões;Treinamento de criação de múltiplos cenários e visões orçamentárias;3,00;3,00;32,00
Orçamento de Pessoal;Itens de Orçamento;Orçamento de Pessoal — Itens de Orçamento;Criação de itens e agrupamentos de despesas;4,00;4,00;32,00
Orçamento de Pessoal;Geração Cenário e Históricos;Orçamento de Pessoal — Geração Cenário e Históricos;Geração e versionamento de cenários;3,00;12,00;32,00
Orçamento de Pessoal;Geração Cenário e Históricos;Orçamento de Pessoal — Geração Cenário e Históricos;Criação de Históricos;4,00;12,00;32,00
Orçamento de Pessoal;Geração Cenário e Históricos;Orçamento de Pessoal — Geração Cenário e Históricos;Manutenção no Orçamento;5,00;12,00;32,00
Orçamento de Pessoal;Cálculo Orçamento e Consultas;Orçamento de Pessoal — Cálculo Orçamento e Consultas;Execução de cálculos, análises e simulações.;4,00;8,00;32,00
Orçamento de Pessoal;Cálculo Orçamento e Consultas;Orçamento de Pessoal — Cálculo Orçamento e Consultas;Consulta do Orçamento Calculado e possíveis manutenções;4,00;8,00;32,00
Orçamento de Pessoal;Relatórios do Módulo;Orçamento de Pessoal — Relatórios do Módulo;Principais Relatórios do Módulo;3,00;3,00;32,00
Treinamento;Cursos;Treinamento — Cursos;Cadastro Cursos de Formação;1,00;4,00;40,00
Treinamento;Cursos;Treinamento — Cursos;Cadastro Cursos de Aperfeiçoamento;1,00;4,00;40,00
Treinamento;Cursos;Treinamento — Cursos;Cadastro Conhecimentos;1,00;4,00;40,00
Treinamento;Cursos;Treinamento — Cursos;Relatórios da Rotina;1,00;4,00;40,00
Treinamento;Requisitos;Treinamento — Requisitos;Vinculação de Requisitos de Treinamentos em Cargos e Postos de Trabalho;2,00;2,00;40,00
Treinamento;Históricos Cursos;Treinamento — Históricos Cursos;Cadastro e Consulta de Históricos de Cursos de Formação;0,50;3,00;40,00
Treinamento;Históricos Cursos;Treinamento — Históricos Cursos;Cadastro e Consulta de Históricos de Aperfeiçoamento;0,50;3,00;40,00
Treinamento;Históricos Cursos;Treinamento — Históricos Cursos;Cadastro e Consulta de Históricos de Conhecimentos;0,50;3,00;40,00
Treinamento;Históricos Cursos;Treinamento — Históricos Cursos;Históricos Gerais por Colaborador;0,50;3,00;40,00
Treinamento;Históricos Cursos;Treinamento — Históricos Cursos;Acompanhamento Vencimentos de Cursos;1,00;3,00;40,00
Treinamento;Orçamento;Treinamento — Orçamento;Itens de Orçamentos;1,00;5,00;40,00
Treinamento;Orçamento;Treinamento — Orçamento;Custos para Orçamento;1,00;5,00;40,00
Treinamento;Orçamento;Treinamento — Orçamento;Previsão Orçamento;1,00;5,00;40,00
Treinamento;Orçamento;Treinamento — Orçamento;Cálculo Orçamento;1,00;5,00;40,00
Treinamento;Orçamento;Treinamento — Orçamento;Relatórios da Rotina;1,00;5,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Cadastros Gerais da Rotina;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Caléndários;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Salas;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;CurSos;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Questionários;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Disponbilidades;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Reservas;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Definição de Turmas;2,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Confirmação de Turmas;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Despesas;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Frequência;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Lançamento de Notas;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Avaliação de Reação;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Relatórios da Rotina;1,00;16,00;40,00
Treinamento;Cursos e Turmas;Treinamento — Cursos e Turmas;Eventos;1,00;16,00;40,00
Treinamento;PDIs;Treinamento — PDIs;Criação de PDIs;2,00;4,00;40,00
Treinamento;PDIs;Treinamento — PDIs;Acompanhamento de PDIs;1,00;4,00;40,00
Treinamento;PDIs;Treinamento — PDIs;Relatórios da Rotina;1,00;4,00;40,00
Treinamento;Auxílio Educação;Treinamento — Auxílio Educação;Definições da Política;2,00;5,00;40,00
Treinamento;Auxílio Educação;Treinamento — Auxílio Educação;Vinculação Colaboradores;1,00;5,00;40,00
Treinamento;Auxílio Educação;Treinamento — Auxílio Educação;Lançamento Recibos;1,00;5,00;40,00
Treinamento;Auxílio Educação;Treinamento — Auxílio Educação;Integração p/ Folha de Pagamento;1,00;5,00;40,00
Treinamento;TR Web;Treinamento — TR Web;Acesso e manusemento TR Web;1,00;1,00;40,00
Cargos e Salário;Cargos;Cargos e Salário — Cargos;Cadastro de Cargos;1,00;2,50;24,00
Cargos e Salário;Cargos;Cargos e Salário — Cargos;Requisitos de Cargos;1,00;2,50;24,00
Cargos e Salário;Cargos;Cargos e Salário — Cargos;Relatórios de Cargos;0,50;2,50;24,00
Cargos e Salário;Postos de Trabalho;Cargos e Salário — Postos de Trabalho;Cadastro Postos de Trabalho;2,00;6,00;24,00
Cargos e Salário;Postos de Trabalho;Cargos e Salário — Postos de Trabalho;Possibilidade Geração Automática Postos de Trabalho (Nativo);1,00;6,00;24,00
Cargos e Salário;Postos de Trabalho;Cargos e Salário — Postos de Trabalho;Hierarquia de Postos de Trabalho;1,00;6,00;24,00
Cargos e Salário;Postos de Trabalho;Cargos e Salário — Postos de Trabalho;Requisitos de Postos;1,00;6,00;24,00
Cargos e Salário;Postos de Trabalho;Cargos e Salário — Postos de Trabalho;Vinculação de Postos aos Colaboradores;0,50;6,00;24,00
Cargos e Salário;Postos de Trabalho;Cargos e Salário — Postos de Trabalho;Relatórios da Rotina;0,50;6,00;24,00
Cargos e Salário;Descrição;Cargos e Salário — Descrição;Cadastro Atividades;1,00;4,00;24,00
Cargos e Salário;Descrição;Cargos e Salário — Descrição;Descrição de Cargos;1,00;4,00;24,00
Cargos e Salário;Descrição;Cargos e Salário — Descrição;Descrição de Postos;1,00;4,00;24,00
Cargos e Salário;Descrição;Cargos e Salário — Descrição;Relatórios da Rotina;1,00;4,00;24,00
Cargos e Salário;Estrutura Salarial;Cargos e Salário — Estrutura Salarial;Cadastro Estruturas Salariais;1,50;4,00;24,00
Cargos e Salário;Estrutura Salarial;Cargos e Salário — Estrutura Salarial;Reajuste Estruturas Salariais;1,00;4,00;24,00
Cargos e Salário;Estrutura Salarial;Cargos e Salário — Estrutura Salarial;Vinculação Estrutura Salariais aos Postos, Cargos e Colaboradores;1,00;4,00;24,00
Cargos e Salário;Estrutura Salarial;Cargos e Salário — Estrutura Salarial;Principais Relatórios da Rotina;0,50;4,00;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Geração Propostas de Cargo;1,00;6,50;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Aprovação Propostas de Cargo;1,00;6,50;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Efetivação Propostas de Cargo;1,00;6,50;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Geração Propostas Salariais;1,00;6,50;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Aprovação Propostas Salariais;1,00;6,50;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Efetivação Propostas Salariais;1,00;6,50;24,00
Cargos e Salário;Propostas;Cargos e Salário — Propostas;Acompanhamento e Relatórios da Rotina;0,50;6,50;24,00
Cargos e Salário;CS Web;Cargos e Salário — CS Web;Acesso e manusemento CS Web;1,00;1,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Valores de Ações Trabalhistas;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Índices de Reclamatórias;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Assuntos;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Tipos de Ação;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Pedidos (autos do processo);0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Andamentos (audiências);0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Varas e Comarcas;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Motivos de Encerramento ;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Definições de Cálculo;0,50;5,00;24,00
Jurídico;Cadastro Básico;Jurídico — Cadastro Básico;Advogados (contrários e defesa da Empresa);0,50;5,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Definições;1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Dados básicos do processo);1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Autor/reclamante;1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Réu;1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Pedidos (autos do processo);1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Testumanhas (parte contrária e empresa);1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Andamentos (audiências);1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Pagamentos;1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Depósitos Recursais;1,00;10,00;24,00
Jurídico;Ações Judiciais;Jurídico — Ações Judiciais;Relatórios;1,00;10,00;24,00
Jurídico;eSocial;Jurídico — eSocial;Definição do Processo;2,00;8,00;24,00
Jurídico;eSocial;Jurídico — eSocial;Cadastro, geração e envio Leiaute S-2500 - Processo Trabalhista;1,50;8,00;24,00
Jurídico;eSocial;Jurídico — eSocial;"Cadastro, geração e envio Leiaute S-2501 - Informações de Tributos Processo Trabalhista;";1,50;8,00;24,00
Jurídico;eSocial;Jurídico — eSocial;Cadastro, geração e envio Leiaute S-3501 - Exclusão de Eventos - Processo Trabalhista;1,50;8,00;24,00
Jurídico;eSocial;Jurídico — eSocial;Detalhamento do Pedido;1,50;8,00;24,00
Jurídico;Integração;Jurídico — Integração;Integração com Adm. de Pessoal (folha);1,00;1,00;24,00
`;

// ---------------------------------------------------
// Função para converter CSV
function parseCSV(csv) {
    const lines = csv.trim().split("\n");
    const headers = lines.shift().split(";").map(h => h.trim());

    return lines.map(line => {
        const cols = line.split(";").map(c => c.trim());
        let obj = {};
        headers.forEach((h, i) => {
            obj[h] = cols[i];
        });
        return obj;
    });
}

let tableData = parseCSV(csvText);

// Preenche data e validade
document.getElementById("dataInput").value = new Date().toLocaleDateString("pt-BR");

let validade = new Date();
validade.setDate(validade.getDate() + 14);
document.getElementById("validadeInput").value = validade.toISOString().split("T")[0];

// --------------------------------------------
// Construir lista de módulos
const moduleListDiv = document.getElementById("moduleList");
let selectedModules = [];
let selectedRoutines = {};

function loadModules() {
    const modules = [...new Set(tableData.map(d => d["MÓDULO"]))];

    modules.forEach(mod => {
        const div = document.createElement("div");
        div.className = "module-item";
        div.textContent = mod;
        div.onclick = () => toggleModule(mod);
        moduleListDiv.appendChild(div);
    });
}

loadModules();

// --------------------------------------------
// Selecionar módulo
function toggleModule(mod) {
    if (!selectedModules.includes(mod)) {
        selectedModules.push(mod);
    } else {
        selectedModules = selectedModules.filter(m => m !== mod);
    }

    loadRoutines();
    updateSummary();
}

// --------------------------------------------
// Carregar rotinas
function loadRoutines() {
    const list = document.getElementById("routineList");
    list.innerHTML = "";

    selectedRoutines = {};

    tableData.forEach(row => {
        if (selectedModules.includes(row["MÓDULO"])) {
            const key = row["MÓDULO - ROTINA"];
            if (!selectedRoutines[key]) {
                selectedRoutines[key] = {
                    modulo: row["MÓDULO"],
                    rotina: row["ROTINA"],
                    especificacoes: [],
                    horas: parseFloat(row["TOTAL ROTINA"].replace(",", "."))
                };
            }
            selectedRoutines[key].especificacoes.push(row["ESPECIFICAÇÃO"]);
        }
    });

    Object.values(selectedRoutines).forEach(r => {
        const card = document.createElement("div");
        card.className = "routine-card";

        card.innerHTML = `
            <div class="routine-header">
                <label>
                    <input type="checkbox" class="checkbox" checked onchange="updateSummary()">
                    <strong>${r.rotina}</strong>
                </label>
                <span>${r.horas} h</span>
            </div>
        `;

        const table = document.createElement("table");
        r.especificacoes.forEach(e => {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>• ${e}</td>`;
            table.appendChild(tr);
        });

        card.appendChild(table);
        list.appendChild(card);
    });
}

// --------------------------------------------
// Atualizar resumo
function updateSummary() {
    const modCount = selectedModules.length;
    document.getElementById("modCount").textContent = modCount;

    let totalHours = 0;
    const routineCards = document.querySelectorAll(".routine-card");

    routineCards.forEach(card => {
        const checkbox = card.querySelector("input[type='checkbox']");
        if (checkbox.checked) {
            const h = parseFloat(card.querySelector("span").innerText);
            totalHours += h;
        }
    });

    document.getElementById("totalHours").textContent = totalHours.toFixed(2);

    const cost = totalHours * 120;
    document.getElementById("estimatedCost").textContent =
        cost.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
}

// --------------------------------------------
// GERAR PDF
async function generatePDF() {

    const cliente = document.getElementById("clienteInput").value.trim();
    const contato = document.getElementById("contatoInput").value.trim();
    const validade = document.getElementById("validadeInput").value;

    if (!cliente) return alert("Preencha o nome do Cliente.");
    if (!contato) return alert("Preencha o telefone de Contato.");
    if (!validade) return alert("Preencha a Validade da Proposta.");

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF();

    let y = 15;

    // Logo
    const logo = new Image();
    logo.src = "logo.png";
    await new Promise(res => logo.onload = res);
    pdf.addImage(logo, "PNG", 10, 10, 40, 20);

    // Título
    pdf.setFontSize(18);
    pdf.text("Escopo de Treinamento – HCM", 60, y + 10);

    y += 25;

    pdf.setFontSize(12);
    pdf.text(`Cliente: ${cliente}`, 10, y); y += 7;
    pdf.text(`Contato: ${contato}`, 10, y); y += 7;
    pdf.text(`Data: ${document.getElementById("dataInput").value}`, 10, y); y += 7;
    pdf.text(`Validade da Proposta: ${validade.split("-").reverse().join("/")}`, 10, y); y += 10;

    pdf.setFontSize(14);
    pdf.text("Escopo Detalhado:", 10, y);
    y += 10;

    Object.values(selectedRoutines).forEach(r => {
        const card = [...document.querySelectorAll(".routine-card")]
            .find(c => c.querySelector("strong").innerText === r.rotina);

        if (!card.querySelector("input").checked) return;

        pdf.setFontSize(13);
        pdf.text(`${r.rotina} (${r.modulo})`, 10, y);
        y += 7;

        pdf.setFontSize(11);
        r.especificacoes.forEach(e => {
            pdf.text(`• ${e}`, 15, y);
            y += 6;
        });

        y += 5;
    });

    pdf.save("Escopo_Treinamento_HCM.pdf");
}

</script>

</body>
</html>
